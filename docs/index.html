<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SHIR: Data-Shielding High-dimensional Integrative Regression â€¢ SHIR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="SHIR: Data-Shielding High-dimensional Integrative Regression">
<meta property="og:description" content="The algorithm performs SHIR, a novel federated learning approach used for aggregating high dimensional and heterogeneous data from local sites, in order to obtain efficient estimators of the logistic model.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">SHIR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/run_example.html">Example on a simulated dataset</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="shir" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#shir" class="anchor"></a>SHIR</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The algorithm performs SHIR, a novel federated learning approach used for aggregating high dimensional and heterogeneous data from local sites, in order to obtain efficient estimators of the logistic model. SHIR protects individual data through a summary-statistics-based integrating procedure. At each local site, it fits LASSO to derive summary data that is free of the individual level information. Susequently, at the central node, it aggregates the derived statistics at the local sites, and produces the integrative estimator.</p>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Meta-analyzing multiple studies allows for more precise estimates and enables investigation of generalizability. However, in the presence of heterogeneity across studies and high dimensional predictors, such integrative analysis is highly challenging. An major application of such integrative analysis is to develop generalizable predictive models using electronic health records (EHR) data from different hospitals. EHR data is subject to high dimensional features and important privacy constraints. The procedure SHIR protects individual data through summary-statistics-based integrating procedure, accommodates between study heterogeneity in both the covariate distribution and model parameters, and attains consistent variable selection.</p>
</div>
<div id="flowchart" class="section level2">
<h2 class="hasAnchor">
<a href="#flowchart" class="anchor"></a>Flowchart</h2>
<p><img src="reference/figures/Flowchart_SHIR.png" alt="Algorithm flowchart"></p>
</div>
<div id="key-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#key-steps" class="anchor"></a>Key steps</h2>
<div id="to-derive-the-local-individual-data" class="section level3">
<h3 class="hasAnchor">
<a href="#to-derive-the-local-individual-data" class="anchor"></a>To derive the local individual data</h3>
<p>At each local site m with indivdual level data (the response vector and design matrix):</p>
<!-- D^{\sf \scriptscriptstyle (m)}=(Y^{\sf \scriptscriptstyle (m)},X^{\sf \scriptscriptstyle (m)}), -->
<p><img src="https://latex.codecogs.com/gif.latex?D%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D=(Y%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D,X%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)," title="D^{\sf \scriptscriptstyle (m)}=(Y^{\sf \scriptscriptstyle (m)},X^{\sf \scriptscriptstyle (m)}),"></p>
<p>we fit lasso:</p>
<!-- \widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)}={\rm argmin}_{\beta}\widehat L(Y^{\sf \scriptscriptstyle (m)};X^{\sf \scriptscriptstyle (m)}\beta)+\lambda_m\|\beta_{-1}\|_1 -->
<p><img src="https://latex.codecogs.com/gif.latex?%5Cwidehat%5Cbeta_%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;LASSO%7D%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D=%7B%5Crm&amp;space;argmin%7D_%7B%5Cbeta%7D%5Cwidehat&amp;space;L(Y%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D;X%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D%5Cbeta)&amp;plus;%5Clambda_m%5C%7C%5Cbeta_%7B-1%7D%5C%7C_1," title="\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)}={\rm argmin}_{\beta}\widehat L(Y^{\sf \scriptscriptstyle (m)};X^{\sf \scriptscriptstyle (m)}\beta)+\lambda_m\|\beta_{-1}\|_1,"></p>
<p>to obtain the summary data (the sample size, hessian matrix, and gradient):</p>
<!-- \{n_m,\widehat H_m,\widehat g_m\},\quad\mbox{where}\quad\widehat H_m=\nabla^2\widehat L_m(\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)});\quad\widehat g_m=\widehat H_m\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)}-\nabla\widehat L_m(\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)}), -->
<p><img src="https://latex.codecogs.com/gif.latex?%5C%7Bn_m,%5Cwidehat&amp;space;H_m,%5Cwidehat&amp;space;g_m%5C%7D,%5Cquad%5Cmbox%7Bwhere%7D%5Cquad%5Cwidehat&amp;space;H_m=%5Cnabla%5E2%5Cwidehat&amp;space;L_m(%5Cwidehat%5Cbeta_%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;LASSO%7D%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D);%5Cquad%5Cwidehat&amp;space;g_m=%5Cwidehat&amp;space;H_m%5Cwidehat%5Cbeta_%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;LASSO%7D%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D-%5Cnabla%5Cwidehat&amp;space;L_m(%5Cwidehat%5Cbeta_%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;LASSO%7D%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)," title="\{n_m,\widehat H_m,\widehat g_m\},\quad\mbox{where}\quad\widehat H_m=\nabla^2\widehat L_m(\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)});\quad\widehat g_m=\widehat H_m\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)}-\nabla\widehat L_m(\widehat\beta_{\sf \scriptscriptstyle LASSO}^{\sf \scriptscriptstyle (m)}),"></p>
<p>and transfer them to the center node for integrative analysis.</p>
</div>
<div id="to-aggregate-the-summary-data" class="section level3">
<h3 class="hasAnchor">
<a href="#to-aggregate-the-summary-data" class="anchor"></a>To aggregate the summary data</h3>
<p>At the center node, we decompose the coefficients into mean effects and heterogeneous effects:</p>
<!-- \{\mu,\alpha^{(\bullet)}\}~\mbox{where}~\alpha^{(\bullet)}=(\alpha^{\sf \scriptscriptstyle (1)},...,\alpha^{\sf \scriptscriptstyle (M)}),~\beta^{\sf \scriptscriptstyle (m)}=\mu+\alpha^{\sf \scriptscriptstyle (m)},~\alpha^{\sf \scriptscriptstyle (1)}+\cdots+\alpha^{\sf \scriptscriptstyle (M)}=0, -->
<p><img src="https://latex.codecogs.com/gif.latex?%5C%7B%5Cmu,%5Calpha%5E%7B(%5Cbullet)%7D%5C%7D~%5Cmbox%7Bwhere%7D~%5Calpha%5E%7B(%5Cbullet)%7D=(%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(1)%7D,...,%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(M)%7D),~%5Cbeta%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D=%5Cmu&amp;plus;%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D,~%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(1)%7D&amp;plus;%5Ccdots&amp;plus;%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(M)%7D=0," title="\{\mu,\alpha^{(\bullet)}\}~\mbox{where}~\alpha^{(\bullet)}=(\alpha^{\sf \scriptscriptstyle (1)},...,\alpha^{\sf \scriptscriptstyle (M)}),~\beta^{\sf \scriptscriptstyle (m)}=\mu+\alpha^{\sf \scriptscriptstyle (m)},~\alpha^{\sf \scriptscriptstyle (1)}+\cdots+\alpha^{\sf \scriptscriptstyle (M)}=0,"></p>
<p>and fit the quadratic-approximated integrative regression:</p>
<!-- \{\widehat\mu_{\sf \scriptscriptstyle SHIR},\widehat\alpha^{(\bullet)}_{\sf \scriptscriptstyle SHIR}\}={\rm argmin}_{\mu,\alpha^{(\bullet)}}N^{-1} \sum_{m=1}^M n_mQ_m(\mu,\alpha^{\sf \scriptscriptstyle (m)})+\lambda(\|\mu_{-1}\|_1+\lambda_g\|\alpha^{(\bullet)}_{-1}\|_{2,1}), -->
<!--\mbox{where}\quad Q_m(\mu,\alpha^{\sf \scriptscriptstyle (m)})=(\mu+\alpha^{\sf \scriptscriptstyle (m)})^{\sf \scriptscriptstyle T}\widehat H_m(\mu+\alpha^{\sf \scriptscriptstyle (m)}) -2\widehat g_m^{\sf \scriptscriptstyle T}(\mu+\alpha^{\sf \scriptscriptstyle (m)}) -->
<p><img src="https://latex.codecogs.com/gif.latex?%5C%7B%5Cwidehat%5Cmu_%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;SHIR%7D,%5Cwidehat%5Calpha%5E%7B(%5Cbullet)%7D_%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;SHIR%7D%5C%7D=%7B%5Crm&amp;space;argmin%7D_%7B%5Cmu,%5Calpha%5E%7B(%5Cbullet)%7D%7DN%5E%7B-1%7D&amp;space;%5Csum_%7Bm=1%7D%5EM&amp;space;n_mQ_m(%5Cmu,%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)&amp;plus;%5Clambda(%5C%7C%5Cmu_%7B-1%7D%5C%7C_1&amp;plus;%5Clambda_g%5C%7C%5Calpha%5E%7B(%5Cbullet)%7D_%7B-1%7D%5C%7C_%7B2,1%7D)," title="\{\widehat\mu_{\sf \scriptscriptstyle SHIR},\widehat\alpha^{(\bullet)}_{\sf \scriptscriptstyle SHIR}\}={\rm argmin}_{\mu,\alpha^{(\bullet)}}N^{-1} \sum_{m=1}^M n_mQ_m(\mu,\alpha^{\sf \scriptscriptstyle (m)})+\lambda(\|\mu_{-1}\|_1+\lambda_g\|\alpha^{(\bullet)}_{-1}\|_{2,1}),"></p>
<p><img src="https://latex.codecogs.com/gif.latex?%5Cmbox%7Bwhere%7D%5Cquad&amp;space;Q_m(%5Cmu,%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)=(%5Cmu&amp;plus;%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;T%7D%5Cwidehat&amp;space;H_m(%5Cmu&amp;plus;%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)&amp;space;-2%5Cwidehat&amp;space;g_m%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;T%7D(%5Cmu&amp;plus;%5Calpha%5E%7B%5Csf&amp;space;%5Cscriptscriptstyle&amp;space;(m)%7D)," title="\mbox{where}\quad Q_m(\mu,\alpha^{\sf \scriptscriptstyle (m)})=(\mu+\alpha^{\sf \scriptscriptstyle (m)})^{\sf \scriptscriptstyle T}\widehat H_m(\mu+\alpha^{\sf \scriptscriptstyle (m)}) -2\widehat g_m^{\sf \scriptscriptstyle T}(\mu+\alpha^{\sf \scriptscriptstyle (m)}),"></p>
<p>to obtain the SHIR estimator. Please see more details from the SHIR paper linked in the citation section.</p>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<!-- You can install the stable version of SHIR from [CRAN](https://CRAN.R-project.org) with: -->
<!-- ``` r -->
<!-- install.packages("SHIR") -->
<!-- ``` -->
<p>The development version of this package can be installed from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># install.packages("devtools")</span>
<span class="kw">devtools</span>::<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"celehs/SHIR"</span>)
</pre></div>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<p>Follow the main steps displayed in the <a href="articles/run_example.html">example</a>, in which we apply SHIR to a simulated dataset.</p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>Cai, T., Liu, M., &amp; Xia, Y. (2021). Individual data protected integrative regression analysis of high-dimensional heterogeneous data. Journal of the American Statistical Association, (just-accepted), 1-34. <a href="https://www.tandfonline.com/doi/abs/10.1080/01621459.2021.1904958" class="uri">https://www.tandfonline.com/doi/abs/10.1080/01621459.2021.1904958</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Molei Liu <br><small class="roles"> Author </small>  </li>
<li>Tianxi Cai <br><small class="roles"> Author </small>  </li>
<li>Clara-Lea Bonzel <br><small class="roles"> Author </small>  </li>
<li> PARSE LTD <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Molei Liu, Tianxi Cai, Clara-Lea Bonzel,  PARSE LTD.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
